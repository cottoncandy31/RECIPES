<h1>レシピ詳細</h1>

<div class='col-md-8 offset-md-1'>
    <table class='table'>
    <tr>

       <td> <% if @recipe.post_image.attached? %>
                  <%= link_to public_recipe_path(@recipe) do %>
                    <%= image_tag @recipe.post_image, size: "100x100" %>
                  <% end %>
                <% else %>
                  <%= image_tag 'no_image', size: "100x100" %>
                <% end %>
        </td>
         <td><%= @recipe.user.name %></td>
        <td><%= @recipe.title %></td>
        <td></td>
        <td><%= @recipe.body %></td>
        <td></td>
        <td></td>
        <td><%= link_to "#{@recipe.comments.count} コメント" %></td>


        <!--<td>-->
        <!--<#% if @recipe.category.present? %>-->
        <!--<#%=link_to @recipe.category,tagsearches_search_path(content: @recipe.category)%>-->
        <!--<#% end %>-->
        <!--</td>-->


        <!--<td>-->
        <!--<#%= link_to recipe_path(@recipe.id), class:"comments-count" do %>-->
        <!--<#%= "コメント数: #{@recipe.comments.count}" %>-->
        <!--<#% end %>-->
        <!--</td>-->

        <!--<td><#%= render 'static.rate', recipe: @recipe %>-->
        <!--</td>-->

        <!--#編集ボタン-->
        <td>
           <% if @recipe.user == current_user %>
           <%= link_to 'Edit', edit_public_recipe_path(@recipe), class: "btn btn-sm btn-success" %>
           <% end %>
        </td>

        <!--♯削除ボタン    -->
        <td>
           <% if @recipe.user == current_user %>
           <%= link_to 'Destroy', public_recipe_path(@recipe), method: :delete, data: { confirm: '本当に消しますか？' }, class: "btn btn-sm btn-danger" %>
           <% end %>
        </td>

            <!--#コメント機能-->
            <div>
              <p>コメント件数：<%= @recipe.comments.count %></p>
              <% @recipe.comments.each do |comment| %>
                
                <%#= comment.user.name %>
                <%#= @comment.created_at.strftime('%Y/%m/%d') %><%#= @comment.comment %>
              <% end %>
            </div>
            
            <div>
                 <!--# コメントについての記述-->
              <%= form_with model: [@recipe, @comment] , url: public_recipe_comments_path(@recipe), method: :post do |f| %>
                <%= f.text_area :comment, rows: '5', placeholder: "コメントをここに" %>
                <%= f.submit "送信する" %>
                
                 <!--# starについての記述-->
                            <% if !@recipe.id.nil? %>
                <div class="form-group" id="star">
                  <%= f.label :star %>
                  <%= f.hidden_field :star, id: :star, class: 'form-control' %>
                  <div id="post_raty"></div>
                </div>
                <script>
                  $(document).on('turbolinks:load', function() {
                    let elem = document.querySelector('#post_raty');
                    if (elem == null) return;
            
                    elem.innerHTML = ""
                    let opt = {
                      starOn: "<%= asset_path('star-on.png') %>",
                      starOff: "<%= asset_path('star-off.png') %>",
                      starHalf: "<%= asset_path('star-half.png') %>",
                      scoreName: 'recipe[star]',
                    };
                    raty(elem, opt);
                  });
                </script>
              <% else %>
                <div class="form-group">
                  <%= render "static_rate", recipe: recipe %>
                </div>
              <% end %>
  
              <% end %>
            </div>
            
            <div>
             <%#= render 'review', recipe: @recipe %>
             <%= render "static_rate", recipe: @recipe %>
            </div>

    </tr>

       <!-- <div class="lists">-->
       <!--   %= render "comments/lists", Recipe: @recipe %>-->
      　<!--</div>-->

  　<!--</table>-->
  　<!-- <div class="lists">-->
   <!--   <#%= render "comments/lists", recipe: @recipe %>-->
  　<!--</div>-->

            <!--#コメント部分の部分テンプレート化し、本のshowページからrenderさせる。-->
   <!--       <#%= render "comments/comment", recipe: @recipe, comment: @comment %>-->

            <!--#remote true追記することで、非同期通信になる-->
            <!--<#%= form_with(model:[@recipe, @comment], remote: true) do |f| %>-->
            <!--<#%= f.text_area :comment, rows: '5', placeholder: "", class:"form-control" %>-->
            <!--<#%= f.submit "送信" %>-->
            <!--<#% end %>-->

   <!-- </div>-->
